<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>URSA Admin Panel</title>
    <link rel="stylesheet" href="admin.css">
    <style>
        /* –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –ø–µ—Ä–µ–Ω–æ—Å–æ–≤ —Å—Ç—Ä–æ–∫ –∏ —É–¥–æ–±—Å—Ç–≤–∞ –≤–≤–æ–¥–∞ */
        textarea {
            resize: vertical;
            line-height: 1.5;
            white-space: pre-wrap !important; /* –°–æ—Ö—Ä–∞–Ω—è–µ—Ç –ø–µ—Ä–µ–Ω–æ—Å—ã –ø—Ä–∏ –≤–≤–æ–¥–µ –∏ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–∏ */
            font-family: inherit;
            width: 100%;
            background: var(--input-bg);
            border: 1px solid var(--border);
            border-radius: 14px;
            padding: 14px;
            color: #fff;
            box-sizing: border-box;
        }
        #features { min-height: 80px; }
        #description { min-height: 120px; }
    </style>
</head>
<body>
    <div id="auth-container" class="admin-container">
        <header>
            <h1>URSA Admin Access</h1>
        </header>
        <div class="admin-section" style="text-align: center;">
            <p style="color: var(--text-secondary); margin-bottom: 20px;">Please sign in with an authorized Google account.</p>
            <button id="login-btn">Sign in with Google</button>
            <div style="text-align: center; margin-top: 15px;">
                <a href="index.html" class="back-link">‚Üê Back to Store</a>
            </div>
        </div>
    </div>

    <div id="admin-main" class="admin-container" style="display: none;">
        <header>
            <div class="header-top">
                <span id="admin-email" style="color: #30d158; font-weight: bold; font-size: 13px;"></span>
                <button id="logout-btn" class="logout-btn">Logout</button>
            </div>
            <h1>Dashboard</h1>
            <a href="index.html" class="back-link">‚Üê Back to Site</a>
        </header>

        <section class="admin-section">
            <h3 id="form-title">IPA Editor</h3>
            <form id="add-app-form" onsubmit="return false;"> 
                <input type="hidden" id="icon_url">
                <input type="hidden" id="download_url">

                <div class="form-group">
                    <label>App Name</label>
                    <input type="text" id="name" required placeholder="e.g. Subway Surfers">
                </div>

                <div class="form-group">
                    <label>App Icon</label>
                    <div class="upload-box">
                        <input type="file" id="icon-input" accept="image/*" class="file-input">
                        <div class="upload-ui">
                            <div class="preview-icon" id="icon-preview">üì∏</div>
                            <span class="status-text" id="icon-status">Tap to upload icon</span>
                            <div class="progress-bar"><div id="icon-progress"></div></div>
                        </div>
                    </div>
                </div>

                <div class="form-group">
                    <label>IPA File</label>
                    <div class="upload-box">
                        <input type="file" id="ipa-input" accept=".ipa" class="file-input">
                        <div class="upload-ui">
                            <div class="preview-icon">üì¶</div>
                            <span class="status-text" id="ipa-status">Tap to select .ipa</span>
                            <div class="progress-bar"><div id="ipa-progress"></div></div>
                        </div>
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label>Section</label>
                        <select id="section" required>
                            <option value="games">üïπ Games</option>
                            <option value="apps">üì± Apps</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Category</label>
                        <input type="text" id="category" required placeholder="Action">
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label>Version</label>
                        <input type="text" id="version" required placeholder="1.0.0">
                    </div>
                    <div class="form-group">
                        <label>Size</label>
                        <input type="text" id="size" required placeholder="100 MB" readonly>
                    </div>
                </div>

                <div class="form-group">
                    <label>Bundle ID</label>
                    <input type="text" id="bundle_id" required placeholder="com.developer.app">
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label>Min iOS</label>
                        <input type="text" id="min_ios" required placeholder="15.0">
                    </div>
                    <div class="form-group">
                        <label>Features (Mod Functions)</label>
                        <textarea id="features" placeholder="Unlimited Coins&#10;God Mode&#10;..."></textarea>
                    </div>
                </div>

                <div class="form-group">
                    <label>Description</label>
                    <textarea id="description" placeholder="Product by URSA"></textarea>
                </div>

                <button type="button" id="manual-submit-btn" class="submit-btn-main" style="width:100%; background:var(--accent); color:white; border:none; padding:18px; border-radius:16px; font-weight:700; font-size:17px; margin-top:10px;">Publish App</button>
            </form>
        </section>

        <section class="admin-section">
            <h3>Inventory</h3>
            <input type="text" id="inventory-search" placeholder="üîç Search..." style="background:rgba(255,255,255,0.05); border:1px solid var(--border); border-radius:12px; padding:12px; color:white; width:100%; box-sizing:border-box; margin-bottom:20px;">
            <div id="admin-app-list"></div>
        </section>

        <footer style="text-align: center; opacity: 0.3; font-size: 10px; padding: 20px 0;">
            URSA IPA Management System ‚Ä¢ 2025
        </footer>
    </div>

    <script type="module" src="admin.js"></script>

    <script>
        // –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ Enter –¥–ª—è –∏–Ω–ø—É—Ç–æ–≤ –∏ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–µ –¥–ª—è textarea (Features –∏ Description)
        document.addEventListener('keydown', function(e) {
            if (e.key === 'Enter') {
                if (e.target.tagName === 'TEXTAREA') {
                    e.stopPropagation(); 
                } else if (e.target.tagName === 'INPUT') {
                    e.preventDefault();
                    return false;
                }
            }
        }, true);

        // –ü—Ä–∏–≤—è–∑–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –∏ –∞–≤—Ç–æ-—Å–∫—Ä–æ–ª–ª –ø—Ä–∏ –Ω–∞–∂–∞—Ç–∏–∏ Edit
        document.addEventListener('DOMContentLoaded', () => {
            const btn = document.getElementById('manual-submit-btn');
            const form = document.getElementById('add-app-form');
            const appList = document.getElementById('admin-app-list');
            
            btn.addEventListener('click', () => {
                form.dispatchEvent(new Event('submit'));
            });

            // –°–ª—É—à–∞—Ç–µ–ª—å –¥–ª—è –∞–≤—Ç–æ-—Å–∫—Ä–æ–ª–ª–∞ –≤–≤–µ—Ä—Ö –ø—Ä–∏ –Ω–∞–∂–∞—Ç–∏–∏ –∫–Ω–æ–ø–∫–∏ Edit –≤ —Å–ø–∏—Å–∫–µ
            appList.addEventListener('click', (e) => {
                if (e.target.classList.contains('edit-btn')) {
                    window.scrollTo({ top: 0, behavior: 'smooth' });
                }
            });
        });
    </script>
</body>
</html>
